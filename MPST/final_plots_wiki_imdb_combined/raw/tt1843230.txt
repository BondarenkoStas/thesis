The Snow Queen's Spell of Shattered Sight, which will turn the townspeople against each other, has been cast and will hit at sundown. Mr. Gold wants to make a deal, though. He says he'll still be there once it's done, and he'll spend every moment trying to rip The Snow Queen's heart out, he tells her. He wants to leave, and he wants to bring Belle and Henry with him. She tells him to enjoy the trip.The gang in Storybrooke sees the spell coming and Regina warns that it will hit by sundown and everyone in town "will start tearing each other apart." Emma suggests they not be in town. They all get to the town line, where The Snow Queen's ice wall sits. David takes a swing at it with an ice pick and it's tossed backward. But Elsa finds Anna's necklace in a crack David created. She takes it as a sign they're "going to win." Regina takes Henry with her as the group splits up.At the pawn shop, Belle can't find an antidote to the spell, but thinks she can create a "vaccine" by using a strand of hair from someone who's been hit by the spell. Elsa hands Belle the necklace that Anna wore and Belle confirms it has mirror dust in it -- which confirms for Elsa that Anna was under the spell when she put Elsa into the urn. Elsa says they need to find Anna.Back in Arendelle, Anna and Kristoff are unfrozen and realize the urn is missing. Anna finds a piece of gold straw and figures Rumplestiltskin has the urn. But Hans gets in the way before Anna can leave and says he's going to charge her with treason for attacking the queen. Anna and Kristoff bust out some impressive moves on Hans' men in order to escape and lock them in the room.At the dock, Mr. Gold asks Hook to get rid of the fairies that are making their home in the diner, working to stop the spell. Hook somehow can't believe that Mr. Gold is putting himself above everyone in town.Regina gets to Robin Hood's camp to warn him about the spell and laments the fact that he and Henry are the only two people in town who believe in her, and the spell will change even that.Emma and Elsa use the locator spell to get the necklace to lead them to Anna. It takes them to the library.In Arendelle, Anna tells Kristoff about "The Wishing Star" that her parents were looking for, which they'd tracked to a pirate named Blackbeard. Anna wants to pay off Blackbeard.The locator leads Elsa and Emma to an apparently recently created rock barrier, but before Elsa can blast it away with a spell Emma stops her and says they should find another way.Anna and Kristoff almost too easily find Blackbeard, who offers them The Wishing Star for "the right price" -- his weight in gold. But it's a setup, and Hans and his men soon appear.In Storybrooke, Grumpy says he and "the guys" can get through the rock barrier. Regina takes the moment to chide Mary Margaret's mayoral skills because the plans aren't up to date. David shows up with some more news to create some dramatic tension: Belle says the counter spell can be made even if they don't find Anna, but it will destroy the necklace -- making the choice to save the whole town or save Anna.Hook and Mr. Gold show up to the diner so that Hook can pulls the fairies into the sorcerer's hat. Mr. Gold tries to pull Belle out, but she refuses to leave. He decides to stay, which doesn't seem to please the lead fairy.The group falls on the side of letting the fairies destroy the necklace, and Emma goes to break the news to Elsa, who hands over the pouch. She leaves -- and still has the necklace in her hand.Emma brings the pouch to the fairies and they find it's full of pebbles. Regina is upset with herself for not having realized by now that she shouldn't trust blondes. Belle says it's too late to make the counter spell with anything but Anna's presence. Emma decides to go help Elsa find her.Emma finds Elsa in the mines and Elsa blasts through the barrier, which leads to a beach.Anna and Kristoff, meanwhile, figure out they've been set up and Blackbeard tells Anna that he sold her parents The Wishing Star, but suggests they perhaps didn't know it only works for someone with a pure heart. Hans tells Anna and Kristoff they're going to die. The two of them are dropped into a trunk that will be dropped into the ocean, but not before Anna learns it's been 30 years since The Snow Queen froze everyone.At the same time, the necklace stops glowing and Elsa worries it's a bad sign. Anna and Kristoff try to escape. Elsa holds the necklace to her chest and wishes Anna were with her. The necklace sends out a surge, the water in the trunk starts to glow and swirl, and -- with a blast -- the trunk emerges from the water in front of Elsa and Emma. Anna and Kristoff pop out of it and there are hugs and smiles all around as the sisters reconnect. The bottle that their parents tossed into the ocean before they died also pops up.Mr. Gold finally gets Belle out of the diner, leaving Hook with the sorcerer's hat to trap the fairies inside. With a jolt through the diner, the fairies begin to be pulled into the hat. One remains, having hidden from Hook for a moment, but he finds her and, after apologizing, pulls her into the hat. Emma gets to the diner with Anna and Elsa in tow, but it's too late. She assumes The Snow Queen has struck, but Hook sits silently behind the counter, hiding from the group as they try to figure out what to do next.Mr. Gold takes Belle to the pawn shop and seals it with what he tells her is a protection spell. He says he'll be back for her and they're be safe.Emma brings Elsa, Anna and Kristoff to the sheriff's station, and Mary Margaret and David tell her the plan: to lock them up in jail cells. Emma doesn't feel good about it, but they insist -- and hands the baby over to her to care for him until the spell passes. Mary Margaret tells Emma that they don't fear her magic and they believe it's what will save them. Hook shows up and Emma gives in to a tearful goodbye kiss.Regina brings Henry to city hall and seals him inside. He says he has faith that Emma and Elsa will save everyone. She goes to seal herself in her vault, worried that she's a danger to others, including Robin Hood.The spell finally hits and we see the first result: Mary Margaret and David pull their hands apart from each other and their faces turn to apparent hatred.