The film is from the perspective of Gonzalo Infante, a privileged Chilean boy, during a time period in which the lower classes are politically mobilized, demanding more rights and forcing fundamental change. At the same time the upper middle class, including Gonzalo's own family, grow fearful of the growing socialist movement and plot against the country's elected president, Salvador Allende. Gonzalo's father, while sympathetic to the poor and not part of the right-wing movement, wants to leave the country to Italy, where he frequently travels for work, to avoid the Socialist policies. Sra. Infante is having an affair with a wealthy older gentleman, who gives Gonzalo gifts to keep him quiet. Gonzalo is sometimes bullied by his sister's boyfriend, who is a violent anti-Allende right-winger who uses nun-chucks to intimidate people. The family often buys products off of the black market, due to rationing and shortages.
Gonzalo Infante attends a private school where the principal, Father McEnroe, introduces five new, poor students. Gonzalo refuses to bully one of these boys, Pedro Machuca, when encouraged by his peers. The two boys become friends. Infante accompanies Machuca, and Machuca's cousin Silvana, as they sell flags at rival political protests. Despite Silvana's initial resentment of Infante's upper-class background, she eventually befriends him and they even exchange kisses. Infante and Machuca visit each other's homes, and meet each other's families.
However, as political unrest grows throughout the movie, the boys' friendship begins to be tested. Machuca's drunk father taunts him, telling him that while Gonzalo and his friends will grow up wealthy, he will be stuck in the lower class cleaning toilets. The upper-class parents of the students at the school are divided on the issue of the new poor students. While some, such as Sr. Infante, support Father McEnroe's policies, many, including Sra. Infante, think that the classes should be segregated. Sra. Infante also encounters Silvana while at a political rally. Although she initially defends the girl from her friends, she eventually is provoked into attacking her. Meanwhile, the school's farming project fails, meaning that they will not be able to keep paying for the poorer students. As class tensions increase, Infante and his friends get into a fight and are driven apart.
The boys witness their country's military coup, where Salvador Allende commits suicide and Augusto Pinochet takes over. Father McEnroe is fired from the newly militarized school, and Machuca is expelled for leading the other students in honoring the priest. Infante tries to visit the shantytown where Machuca and Silvana live, but arrives to find it being destroyed by the soldiers. He then witnesses a soldier murdering Silvana. Infante manages to convince a soldier that he is not from the shantytown due to his nice clothing and fair complexion, and is forced to abandon his friend. He returns to his family's new home, which is now even more opulent thanks to his mother's lover and the new system of government. He remains distraught over the events he has witnessed as he remembers his friends as he stares down at the ruins of their homes.